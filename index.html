<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sidequest Solo - Ultimate</title>
    <style>
        :root {
            --bg: #0f172a;
            --card-bg: #1e293b;
            --accent: #38bdf8;
            --easy: #22c55e;
            --medium: #eab308;
            --hard: #ef4444;
            --text: #f1f5f9;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Inter', -apple-system, sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
            touch-action: none;
        }

        #app {
            width: 100%;
            max-width: 450px;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .screen {
            display: none;
            padding: 20px;
            height: 100%;
            flex-direction: column;
            box-sizing: border-box;
        }

        .screen.active { display: flex; }

        /* HEADER */
        .header { display: flex; justify-content: center; padding: 10px; z-index: 100; }
        .score-badge {
            background: var(--card-bg);
            padding: 8px 20px;
            border-radius: 100px;
            border: 1px solid var(--accent);
            color: var(--accent);
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* KARTEN-STAPEL */
        #card-container {
            position: relative;
            flex-grow: 1;
            margin: 20px 10px 80px 10px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .card {
            position: absolute;
            width: 90%;
            height: 70vh;
            max-height: 450px;
            background: var(--card-bg);
            border-radius: 28px;
            padding: 30px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border: 6px solid #475569;
            transition: transform 0.3s ease, opacity 0.3s ease;
            cursor: grab;
            user-select: none;
            touch-action: none;
        }

        .card.easy { border-color: var(--easy); }
        .card.medium { border-color: var(--medium); }
        .card.hard { border-color: var(--hard); }

        .card-text { font-size: 1.5rem; font-weight: 700; pointer-events: none; line-height: 1.3; }
        .card-lvl { position: absolute; top: 25px; font-size: 0.8rem; opacity: 0.6; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }

        /* Stapel-Effekt f√ºr 6 Karten */
        .card:nth-child(1) { z-index: 6; transform: translate3d(0, 0, 0); }
        .card:nth-child(2) { z-index: 5; transform: translate3d(0, 10px, 0) scale(0.96); opacity: 0.9; }
        .card:nth-child(3) { z-index: 4; transform: translate3d(0, 20px, 0) scale(0.92); opacity: 0.8; }
        .card:nth-child(4) { z-index: 3; transform: translate3d(0, 30px, 0) scale(0.88); opacity: 0.7; }
        .card:nth-child(5) { z-index: 2; transform: translate3d(0, 40px, 0) scale(0.84); opacity: 0.6; }
        .card:nth-child(6) { z-index: 1; transform: translate3d(0, 50px, 0) scale(0.80); opacity: 0.5; }

        /* FOOTER */
        .footer { padding: 20px; z-index: 100; }
        .btn-primary { background: var(--accent); color: #000; border: none; padding: 18px; border-radius: 20px; font-weight: bold; width: 100%; cursor: pointer; font-size: 1.1rem; }
        .btn-danger { background: #334155; color: white; border: none; padding: 14px; border-radius: 16px; width: 100%; cursor: pointer; margin-top: 10px; font-weight: bold; opacity: 0.8; }

        /* REVIEW */
        .review-item { background: var(--card-bg); padding: 15px; margin-bottom: 10px; border-radius: 18px; display: flex; justify-content: space-between; align-items: center; border-left: 6px solid var(--accent); }
        .review-item.removed { opacity: 0.2; text-decoration: line-through; border-left-color: #475569; }
        .btn-del { background: var(--hard); border: none; color: white; border-radius: 50%; width: 32px; height: 32px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div id="app">
    <section id="screen-howto" class="screen active">
        <div style="text-align:center; margin-top:20%; padding: 20px;">
            <h1 style="font-size: 3rem; margin-bottom: 10px;">üïµÔ∏è‚Äç‚ôÇÔ∏è Sidequest</h1>
            <p style="opacity: 0.7; font-size: 1.1rem;">Das geheime Spiel f√ºr Zwischendurch.</p>
            <div style="background: rgba(255,255,255,0.05); padding: 25px; border-radius: 24px; margin: 30px 0; text-align: left;">
                <p>‚úÖ <b>Swipe RECHTS:</b> Erf√ºllt!</p>
                <p>‚ùå <b>Swipe LINKS:</b> Neue Karte (-2 Pkt)</p>
                <p style="font-size: 0.8rem; margin-top: 15px; opacity: 0.6;">Du hast immer 6 Karten zur Auswahl. Entscheide weise, welche du versuchst.</p>
            </div>
            <button class="btn-primary" onclick="startGame()">SPIEL STARTEN</button>
        </div>
    </section>

    <section id="screen-game" class="screen">
        <div class="header">
            <div class="score-badge">Punkte: <span id="display-score">0</span></div>
        </div>
        <div id="card-container"></div>
        <div class="footer">
            <button class="btn-danger" onclick="endGameRequest()">SPIEL BEENDEN</button>
        </div>
    </section>

    <section id="screen-review" class="screen">
        <h2 style="text-align: center;">Veto-Runde ‚öñÔ∏è</h2>
        <p style="font-size: 0.9rem; text-align: center; opacity: 0.7; margin-bottom: 20px;">Tippe auf das X bei Aufgaben, die du doch nicht geschafft hast.</p>
        <div id="review-list" style="overflow-y:auto; flex-grow:1; padding-right: 5px;"></div>
        <button class="btn-primary" onclick="showFinalResult()">SCORE BEST√ÑTIGEN</button>
    </section>

    <section id="screen-result" class="screen">
        <div style="text-align:center; margin-top:30%">
            <h2 style="opacity: 0.8;">Dein Endergebnis:</h2>
            <h1 id="final-score" style="font-size:6rem; color:var(--accent); margin: 10px 0;">0</h1>
            <p style="font-size: 1.2rem; margin-bottom: 40px;">Punkte erreicht!</p>
            <button class="btn-primary" onclick="location.reload()">NEUSTART</button>
        </div>
    </section>
</div>

<script>
const CHALLENGES = {
    easy: [
        "Ber√ºhre unauff√§llig dreimal dein linkes Ohr.", "Sage in einem Satz das Wort 'Gurkensalat'.", "Trinke dein Glas in einem Zug leer.", "Stelle eine belanglose Frage √ºber das Wetter.", "G√§hne einmal laut und deutlich.", "R√ºcke deinen Stuhl zwei Mal hintereinander zurecht.", "Putze deine Brille oder reibe dir intensiv die Augen.", "Schau kurz auf dein Handy und kichere leise.", "Streichle dir nachdenklich √ºber das Kinn.", "Ver√§ndere deine Sitzposition sehr auff√§llig.", "Summe f√ºr 5 Sekunden eine Melodie leise.", "√úberpr√ºfe unauff√§llig, ob dein Atem riecht.", "Frage in die Runde: 'Hat jemand mal ein Taschentuch?'", "Tippe f√ºnfmal mit dem Fu√ü im Takt auf den Boden.", "Schau auf deine Uhr und sch√ºttle kurz den Kopf.", "Ordne Gegenst√§nde auf dem Tisch symmetrisch an.", "Fahre dir mit der Hand durch die Haare.", "Verschr√§nke die Arme und atme tief aus.", "Frage jemanden: 'Wann hast du eigentlich Geburtstag?'", "Nimm einen Schluck und sage danach leise 'Ahhh'.", "Kratze dich am Ellenbogen.", "Schau f√ºr 10 Sekunden konzentriert an die Decke.", "Putze unauff√§llig mit dem Finger √ºber dein Display.", "Lockere deinen Nacken durch Kreisen des Kopfes.", "Suche in deiner Tasche nach etwas, das nicht da ist.", "Z√§hle laut bis drei, bevor du etwas sagst.", "Benutze das Wort 'tats√§chlich' zweimal in einem Satz.", "Stelle dein Getr√§nk auf die andere Seite von dir.", "Strecke deine Beine lang unter dem Tisch aus.", "Lies ein Etikett einer Flasche aufmerksam durch.", "R√§usper dich zwei Mal kurz hintereinander.", "Zupfe an deinem √Ñrmel herum.", "Frage: 'Ist es hier eigentlich w√§rmer geworden?'", "Halte dein Handy ans Ohr (ohne Anruf).", "Wippe f√ºr 20 Sekunden leicht mit dem Oberk√∂rper.", "Pr√ºfe, ob deine Schuhe fest sitzen.", "L√§chele eine Person grundlos an.", "Trommle mit zwei Fingern kurz auf den Tisch.", "Sage: 'Interessant...' zu einer normalen Aussage.", "Z√§hle die Fenster im Raum.", "Ber√ºhre mit der Zunge deine Oberlippe.", "Puste eine imagin√§re Fluse von der Schulter.", "Verstelle deine Stimme f√ºr ein Wort.", "Schlage die Beine drei Mal anders √ºbereinander.", "Pr√ºfe deinen Geldbeutel.", "Lobe das Design einer Lampe.", "Knacke mit einem Fingergelenk.", "Rieche kurz an deinem Getr√§nk.", "Nicke drei Mal, w√§hrend jemand anderes redet.", "Zieh deine Augenbrauen kurz hoch.", "Sage: 'Wie dem auch sei...'", "Pr√ºfe dein Spiegelbild im Handy.", "Sage: 'Verr√ºckt eigentlich.'", "St√ºtze deinen Kopf auf beide H√§nde.", "Sage das Wort 'quasi' in einem Satz.", "Bewege deine Zehen sichtbar.", "Frage: 'Geht's euch gut?'", "Streichle √ºber die Tischkante.", "Sage: 'Kann man machen.'", "Rieche an deinem √Ñrmel.", "Klopfe leise auf dein Knie.", "Tippe mit dem Rhythmus eines Liedes gegen dein Glas.", "Halte dein Glas f√ºr 10 Sekunden fest, ohne zu trinken.", "Frage: 'Hat jemand Hunger?'", "Spiele kurz mit einem Feuerzeug.", "Wische dir √ºber die Stirn.", "Frage jemanden: 'Ist das neu?'", "Sage: 'Muss ja, ne?'", "R√ºcke dein Glas 1cm nach links.", "Tu so als h√§ttest du einen Kr√ºmel auf dem Shirt.", "Sage: 'Klassiker!'", "Guck 5 Sekunden aus dem Fenster.", "Reibe deine Handfl√§chen aneinander.", "Nimm das Glas mit der linken Hand.", "Sage: 'Man kennt es.'", "Kratze dich am Kinn.", "Schau kurz auf dein Fingern√§gel.", "Summe den Ton von 'Alle meine Entchen'.", "Vergleiche die F√ºllh√∂he von zwei Gl√§sern.", "Puste in dein leeres Glas.", "R√ºcke deine Socken zurecht.", "Sch√ºttle dein Handy (schlechter Empfang).", "Frage: 'Habt ihr das auch geh√∂rt?'", "√úberpr√ºfe unauff√§llig deinen Puls.", "Strecke kurz einen Arm nach oben.", "Tippe dir mit dem Finger an die Schl√§fe.", "Stelle sicher, dass dein Stuhl 90 Grad zum Tisch steht.", "Knete kurz dein Ohrl√§ppchen.", "Sag das Wort 'Logischerweise'.", "Spiel mit deinem Ring oder deiner Uhr.", "Klopfe Staub von deiner Hose.", "Sage: 'Schwierig.'", "Schau auf deine Handfl√§che (Notizen).", "Atme h√∂rbar durch die Nase ein.", "Stelle dein Glas auf den alten Abdruck.", "Guck kurz hinter dich.", "Z√§hle laut bis 3.", "S√§ubere eine Stelle auf dem Tisch.", "Klopfe dir auf die Wangen.", "Guck auf dein Handy und kichere."
    ],
    medium: [
        "Laufe einmal im Kreis durch den Raum.", "Tausche unauff√§llig den Platz.", "Fl√ºstere eine belanglose Nachricht.", "Lache laut √ºber einen schlechten Witz.", "Benutze 'fabelhaft' dreimal.", "Behaupte, du h√§ttest eine Spinne gesehen.", "Frage nach der Zeit (Handy in der Hand).", "Summe 10 Sek. 'Happy Birthday'.", "Wiederhole das letzte Wort deines Vorredners als Frage.", "Geh zum Fenster, schau raus, komm kopfsch√ºttelnd zur√ºck.", "Behaupte, du h√§ttest ein Pfeifen im Ohr.", "Erkl√§re 1 Min. ein fiktives Hobby.", "Benutze eine Redewendung falsch.", "Stelle dein Getr√§nk auf den Boden.", "Klatsche pl√∂tzlich (M√ºcke fangen).", "Frage: 'Riecht es hier nach verbranntem Toast?'", "Mach ein Selfie mit jemandem im Hintergrund.", "Erz√§hle eine Geschichte, die mittendrin aufh√∂rt.", "Verlange ein High-Five.", "Setz dir 2 Min. eine Kapuze auf.", "Stelle Handy auf volle Lautst√§rke (Ton abspielen).", "Frage: 'Glaubt ihr an Geister?'", "Behaupte ein D√©j√†-vu zu haben.", "Sprich 1 Min. in 3-Wort-S√§tzen.", "Guck jemanden irritiert an.", "Verteile 3 Komplimente.", "Trinke laut mit Strohhalm.", "Zitiere eine Songzeile.", "Halte eine brennende Kerze 10 Sek. an.", "Frage nach Lieblings-Dinosaurier.", "Tu so als h√§ttest du einen Krampf.", "Vorteile von Leitungswasser erkl√§ren.", "Sage: 'Du siehst aus wie ein Promi'.", "Putze mit Serviette den Tisch.", "Tippe wild auf dem Handy.", "Verstelle deine Stimme f√ºr einen Satz.", "Frage nach Kartenspiel.", "Singe Werbe-Jingle.", "Bitte um Hilfe beim Kette entknoten.", "Behaupte von jemandem getr√§umt zu haben.", "Verabschiede dich (ohne zu gehen).", "H√ºpfe einmal vor Energie.", "Frage nach Wasser (trotz vollem Glas).", "Lies Zutatenliste laut vor.", "Behaupte 4 Liter Wasser getrunken zu haben.", "Frage nach erstem Haustier.", "Starre jemanden 10 Sek. an.", "Zeig in eine leere Ecke.", "Stelle Glas auf den Kopf (leer).", "Alligator vs. Krokodil Diskussion.", "Benutze Wort 'Antiquiert'.", "Lobe die Akustik.", "Frage nach Sternzeichen.", "Gib jemandem einen Spitznamen.", "Halte Glas mit beiden H√§nden.", "Zombie-Apokalypse √úberlebens-Check.", "Sage: 'Erinnert mich an Film XY'.", "Balanciere einen Stift auf dem Finger.", "Frage nach Serien-Empfehlung.", "Huste 3x im Rhythmus.", "Lobe jemanden √ºbertrieben.", "Erz√§hle von nutzloser App.", "Behaupte Promi-Treffen.", "Holz-Check am Tisch.", "Ananas-Tattoo Idee erw√§hnen.", "Schlage Gruppenfoto vor.", "Frage nach Musikinstrumenten.", "Sage: 'Das ist typisch ich'.", "Vergiss ein einfaches Wort (Gabel).", "Eichh√∂rnchen-Rettung erfinden.", "Frage nach Lieblings-Monat.", "Zeh ist eingeschlafen.", "Ente-Pferd-Frage stellen.", "Dehn√ºbung machen.", "Frage nach Pizza.", "Neues Wort erfunden.", "Regen-Prognose abgeben.", "Island-Urlaub Wunsch.", "Kaugummi suchen.", "Frage nach WLAN-Passwort.", "Farben-Kompliment Kleidung.", "Ohren wackeln Versuch.", "Peinlicher Moment Frage.", "Vegetarier f√ºr 24h Idee.", "Bedeutung Vorname fragen.", "Sage: 'F√ºhle mich heute blau'.", "Imagin√§re Fernbedienung nutzen.", "Bestes Geschenk Frage.", "Schlumpf-Ohrwurm.", "Wettbewerb-Sieg erfinden.", "Delfin-Fakt erz√§hlen.", "Getr√§nk ist besonders nass.", "Schnurrbart-Frage stellen.", "Vortrag √ºber Vorteile von Socken.", "In die H√§nde klatschen und 'So!' sagen.", "Einen imagin√§ren Hut ziehen.", "Jemanden fragen: 'Bist du sauer?'", "Einen Akzent f√ºr genau zwei S√§tze nutzen.", "Sagen: 'Das hat mein Opa schon immer gesagt'.", "Lautes Ausatmen gefolgt von 'Tja'."
    ],
    hard: [
        "Zieh Socken falsch herum an.", "Behaupte es h√§tte geklopft.", "5 Liegest√ºtze mitten im Raum.", "Alle m√ºssen kurz aufstehen.", "Sprich 2 Min. mit Akzent.", "Rede √ºber nasses Wasser (30 Sek).", "Setz dich 1 Min. auf den Boden.", "30 Sek. Schluckauf vort√§uschen.", "Hand 5 Sek. nach High-Five halten.", "Panischer Blick aus dem Fenster.", "Handy suchen (in der Hand).", "Luftgitarre spielen (15 Sek).", "Simulation-Theorie diskutieren.", "Sage nach jedem Satz 'Over'.", "In die Ecke stellen (1 Min).", "Geist-SMS behaupten.", "Stuhl-Versicherung verkaufen.", "Schuhe an den H√§nden tragen.", "Refrain laut singen.", "Wikipedia √ºber Brot vorlesen.", "Foto von Schuhen machen wollen.", "Eignen Namen vergessen.", "Kompliment an eine Gabel.", "1 Min. lang fl√ºstern.", "Streit mit unsichtbarer Person.", "Zeitreisender aus 1920 sein.", "Alle zum Singen bringen.", "Topf als Hut tragen.", "Nur in Reimen sprechen.", "Allergie gegen Wort 'und'.", "Hand halten (Angst).", "Toaster-Entf√ºhrung erz√§hlen.", "Zeitlupen-Trinken.", "Am Haar von jemandem riechen.", "Mit 'Eure Majest√§t' ansprechen lassen.", "Zukunft aus Chips lesen.", "Unsichtbarer Hund an Leine.", "Ersch√ºtterung der Macht sp√ºren.", "Behaupte du bist Spion.", "Tierger√§usch machen.", "Setzen verlernt.", "La-Ola-Welle starten.", "Glas exen auf Kommando.", "Telepathie mit Katze.", "Mond aus K√§se Theorie.", "Pinguin-Diskussion starten.", "Serviette als Krawatte.", "Unsichtbare Brille suchen.", "Lebewesen im Glas retten.", "Nur in Fragen sprechen.", "Erfundene Sprache sprechen.", "Aura reinigen lassen.", "Tanzen ohne Musik.", "Stuhl hat gebissen.", "Angst vor Dunkelheit.", "Werwolf-Verwandlung spielen.", "Schatten verkaufen.", "Haare gr√ºn f√§rben Frage.", "Socken vorlesen.", "Phobie gegen 'Sidequest'.", "Farben h√∂ren.", "Knie taufen.", "Kaffeemaschinen-Ger√§usch.", "Rad erfunden.", "Falscher Name f√ºr Freunde.", "Unsichtbarer Hut ziehen.", "L√∂ffel auf Nase.", "K√∂nig eines Kleinstaates.", "Atmen lernen wollen.", "Territorium markieren.", "10 Sek. Gespr√§chspause & Starren.", "Weltuntergangs-Vision.", "Regierungs-Agent Frage.", "Star Wars summen.", "Angst vor runden Objekten.", "Gartenzwerg-Rechte.", "Linker Arm geh√∂rt wem anders.", "Schaufel suchen (vergraben).", "Interview mit Pflanze.", "Durch W√§nde gehen wollen.", "Luft-Kalorien z√§hlen.", "Formel-1 Ger√§usch.", "Mit Ger√§ten sprechen.", "Gesicht als Leinwand.", "Majest√§tisch schreiten.", "Fliege mit St√§bchen fangen.", "K√§se-Alter riechen.", "Imagin√§rer Freund beleidigt.", "Dramatische Ohnmacht.", "Internet gel√∂scht.", "Sind wir schon da? (3x).", "Fernbedienung f√ºr Menschen.", "Angst vor eigenem Schatten.", "Socken ausleihen.", "Letzte Gehirnzelle verloren.", "Hypnotisieren versuchen.", "Allergie gegen Sauerstoff.", "Selfie mit Keks.", "Yoga-Pose f√ºr 10 Sekunden.", "Ein fiktives Produkt verkaufen.", "So tun, als w√ºrde man unsichtbare F√§den ziehen."
    ]
};

let score = 0;
let cards = [];
let doneChallenges = [];
let usedTexts = new Set();
let isDragging = false;
let startX = 0;
let currentTranslateX = 0;

function startGame() {
    showScreen('screen-game');
    // Initialer Stapel (immer 6 Karten: 2 leicht, 2 mittel, 2 schwer)
    cards = [
        { type: 'easy', text: getNewQuest('easy') },
        { type: 'easy', text: getNewQuest('easy') },
        { type: 'medium', text: getNewQuest('medium') },
        { type: 'medium', text: getNewQuest('medium') },
        { type: 'hard', text: getNewQuest('hard') },
        { type: 'hard', text: getNewQuest('hard') }
    ];
    renderCards();
}

function getNewQuest(lvl) {
    const pool = CHALLENGES[lvl];
    const available = pool.filter(t => !usedTexts.has(t));
    const list = available.length > 0 ? available : pool;
    const picked = list[Math.floor(Math.random() * list.length)];
    usedTexts.add(picked);
    return picked;
}

function renderCards() {
    const container = document.getElementById('card-container');
    container.innerHTML = "";
    cards.forEach((card, index) => {
        const div = document.createElement('div');
        div.className = `card ${card.type}`;
        div.innerHTML = `
            <div class="card-lvl">${card.type}</div>
            <div class="card-text">${card.text}</div>
        `;
        
        // Nur die oberste Karte kann man ziehen
        if (index === 0) {
            div.addEventListener('mousedown', startDrag);
            div.addEventListener('touchstart', startDrag);
        }
        container.appendChild(div);
    });
}

// SWIPE LOGIK
function startDrag(e) {
    isDragging = true;
    startX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
    const topCard = document.querySelector('.card:first-child');
    topCard.style.transition = 'none';
    
    document.addEventListener('mousemove', onDrag);
    document.addEventListener('touchmove', onDrag);
    document.addEventListener('mouseup', endDrag);
    document.addEventListener('touchend', endDrag);
}

function onDrag(e) {
    if (!isDragging) return;
    const x = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
    currentTranslateX = x - startX;
    const topCard = document.querySelector('.card:first-child');
    const rotate = currentTranslateX / 15;
    topCard.style.transform = `translateX(${currentTranslateX}px) rotate(${rotate}deg)`;
    
    // Visuelles Feedback beim Ziehen
    if (currentTranslateX > 50) topCard.style.backgroundColor = "rgba(34, 197, 94, 0.5)";
    else if (currentTranslateX < -50) topCard.style.backgroundColor = "rgba(239, 68, 68, 0.5)";
    else topCard.style.backgroundColor = "var(--card-bg)";
}

function endDrag() {
    if (!isDragging) return;
    isDragging =
