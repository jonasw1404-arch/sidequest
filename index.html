<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sidequest Solo - 6 Card Stack</title>
    <style>
        :root {
            --bg: #0f172a;
            --card-bg: #1e293b;
            --accent: #38bdf8;
            --easy: #22c55e;
            --medium: #eab308;
            --hard: #ef4444;
            --text: #f1f5f9;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
            touch-action: none;
        }

        #app {
            width: 100%;
            max-width: 450px;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .screen {
            display: none;
            padding: 20px;
            height: 100%;
            flex-direction: column;
            box-sizing: border-box;
        }

        .screen.active { display: flex; }

        /* HEADER */
        .header { display: flex; justify-content: center; padding: 15px; z-index: 100; }
        .score-badge {
            background: var(--card-bg);
            padding: 10px 25px;
            border-radius: 50px;
            border: 2px solid var(--accent);
            color: var(--accent);
            font-weight: 800;
            font-size: 1.3rem;
            box-shadow: 0 4px 15px rgba(56, 189, 248, 0.2);
        }

        /* KARTEN-STAPEL LOGIK */
        #card-container {
            position: relative;
            flex-grow: 1;
            margin: 30px 20px 100px 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .card {
            position: absolute;
            width: 100%;
            height: 75vh;
            max-height: 480px;
            background: var(--card-bg);
            border-radius: 30px;
            padding: 35px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0,0,0,0.6);
            border: 6px solid #475569;
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.3s ease;
            cursor: grab;
            user-select: none;
        }

        .card.easy { border-color: var(--easy); }
        .card.medium { border-color: var(--medium); }
        .card.hard { border-color: var(--hard); }

        .card-text { font-size: 1.6rem; font-weight: 700; line-height: 1.4; pointer-events: none; }
        .card-lvl { position: absolute; top: 30px; font-size: 0.9rem; opacity: 0.5; font-weight: 900; text-transform: uppercase; letter-spacing: 2px; }

        /* Visuelle Schichtung der 6 Karten */
        .card:nth-child(1) { z-index: 6; transform: translate3d(0, 0, 0); opacity: 1; }
        .card:nth-child(2) { z-index: 5; transform: translate3d(0, 15px, 0) scale(0.95); opacity: 0.85; }
        .card:nth-child(3) { z-index: 4; transform: translate3d(0, 30px, 0) scale(0.90); opacity: 0.7; }
        .card:nth-child(4) { z-index: 3; transform: translate3d(0, 45px, 0) scale(0.85); opacity: 0.5; }
        .card:nth-child(5) { z-index: 2; transform: translate3d(0, 60px, 0) scale(0.80); opacity: 0.3; }
        .card:nth-child(6) { z-index: 1; transform: translate3d(0, 75px, 0) scale(0.75); opacity: 0.15; }

        /* FOOTER & BUTTONS */
        .footer { padding: 20px; z-index: 100; }
        .btn-primary { background: var(--accent); color: #000; border: none; padding: 20px; border-radius: 25px; font-weight: 900; width: 100%; cursor: pointer; font-size: 1.2rem; text-transform: uppercase; }
        .btn-danger { background: transparent; color: #64748b; border: 2px solid #334155; padding: 12px; border-radius: 15px; width: 100%; cursor: pointer; margin-top: 15px; font-weight: bold; }

        /* REVIEW LIST */
        .review-item { background: var(--card-bg); padding: 18px; margin-bottom: 12px; border-radius: 20px; display: flex; justify-content: space-between; align-items: center; border-left: 8px solid var(--accent); }
        .review-item.removed { opacity: 0.15; text-decoration: line-through; filter: grayscale(1); }
        .btn-del { background: var(--hard); border: none; color: white; border-radius: 50%; width: 35px; height: 35px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div id="app">
    <section id="screen-howto" class="screen active">
        <div style="text-align:center; margin-top:15%; padding: 20px;">
            <h1 style="font-size: 3.5rem; margin-bottom: 0;">SIDE</h1>
            <h1 style="font-size: 3.5rem; color: var(--accent); margin-top: -15px;">QUEST</h1>
            <p style="opacity: 0.6; margin-bottom: 40px;">Wähle aus 6 geheimen Aufgaben.</p>
            <div style="background: rgba(255,255,255,0.03); padding: 30px; border-radius: 30px; margin-bottom: 40px;">
                <p>✅ Swipe <b>RECHTS</b>: Geschafft!</p>
                <p>❌ Swipe <b>LINKS</b>: Neue Karte (-2)</p>
            </div>
            <button class="btn-primary" onclick="startGame()">Starten</button>
        </div>
    </section>

    <section id="screen-game" class="screen">
        <div class="header">
            <div class="score-badge"><span id="display-score">0</span> PKT</div>
        </div>
        <div id="card-container"></div>
        <div class="footer">
            <button class="btn-danger" onclick="endGameRequest()">SPIEL BEENDEN</button>
        </div>
    </section>

    <section id="screen-review" class="screen">
        <h2 style="text-align: center; font-size: 2rem;">Veto? ⚖️</h2>
        <div id="review-list" style="overflow-y:auto; flex-grow:1; padding: 10px;"></div>
        <button class="btn-primary" onclick="showFinalResult()">Fertig</button>
    </section>

    <section id="screen-result" class="screen">
        <div style="text-align:center; margin-top:30%">
            <h2 style="opacity: 0.5;">Dein Score:</h2>
            <h1 id="final-score" style="font-size:7rem; color:var(--accent); margin: 0;">0</h1>
            <button class="btn-primary" onclick="location.reload()" style="margin-top: 50px;">Nochmal</button>
        </div>
    </section>
</div>

<script>
const CHALLENGES = {
    easy: ["Berühre unauffällig dreimal dein linkes Ohr.", "Sage in einem Satz das Wort 'Gurkensalat'.", "Trinke dein Glas in einem Zug leer.", "Stelle eine belanglose Frage über das Wetter.", "Gähne einmal laut und deutlich.", "Rücke deinen Stuhl zwei Mal hintereinander zurecht.", "Putze deine Brille oder reibe dir intensiv die Augen.", "Schau kurz auf dein Handy und kichere leise.", "Streichle dir nachdenklich über das Kinn.", "Verändere deine Sitzposition sehr auffällig.", "Summe für 5 Sekunden eine Melodie leise.", "Überprüfe unauffällig, ob dein Atem riecht.", "Frage in die Runde: 'Hat jemand mal ein Taschentuch?'", "Tippe fünfmal mit dem Fuß im Takt auf den Boden.", "Schau auf deine Uhr und schüttle kurz den Kopf.", "Ordne Gegenstände auf dem Tisch symmetrisch an.", "Fahre dir mit der Hand durch die Haare.", "Verschränke die Arme und atme tief aus.", "Frage jemanden: 'Wann hast du eigentlich Geburtstag?'", "Nimm einen Schluck und sage danach leise 'Ahhh'.", "Kratze dich am Ellenbogen.", "Schau für 10 Sekunden konzentriert an die Decke.", "Putze unauffällig mit dem Finger über dein Display.", "Lockere deinen Nacken durch Kreisen des Kopfes.", "Suche in deiner Tasche nach etwas, das nicht da ist.", "Zähle laut bis drei, bevor du etwas sagst.", "Benutze das Wort 'tatsächlich' zweimal in einem Satz.", "Stelle dein Getränk auf die andere Seite von dir.", "Strecke deine Beine lang unter dem Tisch aus.", "Lies ein Etikett einer Flasche aufmerksam durch.", "Räusper dich zwei Mal kurz hintereinander.", "Zupfe an deinem Ärmel herum.", "Frage: 'Ist es hier eigentlich wärmer geworden?'", "Halte dein Handy ans Ohr (ohne Anruf).", "Wippe für 20 Sekunden leicht mit dem Oberkörper.", "Prüfe, ob deine Schuhe fest sitzen.", "Lächele eine Person grundlos an.", "Trommle mit zwei Fingern kurz auf den Tisch.", "Sage: 'Interessant...' zu einer normalen Aussage.", "Zähle die Fenster im Raum.", "Berühre mit der Zunge deine Oberlippe.", "Puste eine imaginäre Fluse von der Schulter.", "Verstelle deine Stimme für ein Wort.", "Schlage die Beine drei Mal anders übereinander.", "Prüfe deinen Geldbeutel.", "Lobe das Design einer Lampe.", "Knacke mit einem Fingergelenk.", "Rieche kurz an deinem Getränk.", "Nicke drei Mal, während jemand anderes redet.", "Zieh deine Augenbrauen kurz hoch.", "Sage: 'Wie dem auch sei...'", "Prüfe dein Spiegelbild im Handy.", "Sage: 'Verrückt eigentlich.'", "Stütze deinen Kopf auf beide Hände.", "Sage das Wort 'quasi' in einem Satz.", "Bewege deine Zehen sichtbar.", "Frage: 'Geht's euch gut?'", "Streichle über die Tischkante.", "Sage: 'Kann man machen.'", "Rieche an deinem Ärmel.", "Klopfe leise auf dein Knie.", "Tippe mit dem Rhythmus eines Liedes gegen dein Glas.", "Halte dein Glas für 10 Sekunden fest, ohne zu trinken.", "Frage: 'Hat jemand Hunger?'", "Spiele kurz mit einem Feuerzeug.", "Wische dir über die Stirn.", "Frage jemanden: 'Ist das neu?'", "Sage: 'Muss ja, ne?'", "Rücke dein Glas 1cm nach links.", "Tu so als hättest du einen Krümel auf dem Shirt.", "Sage: 'Klassiker!'", "Guck 5 Sekunden aus dem Fenster.", "Reibe deine Handflächen aneinander.", "Nimm das Glas mit der linken Hand.", "Sage: 'Man kennt es.'", "Kratze dich am Kinn.", "Schau kurz auf dein Fingernägel.", "Summe den Ton von 'Alle meine Entchen'.", "Vergleiche die Füllhöhe von zwei Gläsern.", "Puste in dein leeres Glas.", "Rücke deine Socken zurecht.", "Schüttle dein Handy (schlechter Empfang).", "Frage: 'Habt ihr das auch gehört?'", "Überprüfe unauffällig deinen Puls.", "Strecke kurz einen Arm nach oben.", "Tippe dir mit dem Finger an die Schläfe.", "Stelle sicher, dass dein Stuhl 90 Grad zum Tisch steht.", "Knete kurz dein Ohrläppchen.", "Sag das Wort 'Logischerweise'.", "Spiel mit deinem Ring oder deiner Uhr.", "Klopfe Staub von deiner Hose.", "Sage: 'Schwierig.'", "Schau auf deine Handfläche (Notizen).", "Atme hörbar durch die Nase ein.", "Stelle dein Glas auf den alten Abdruck.", "Guck kurz hinter dich.", "Zähle laut bis 3.", "Säubere eine Stelle auf dem Tisch.", "Klopfe dir auf die Wangen.", "Guck auf dein Handy und kichere."],
    medium: ["Kreis laufen", "Platz tauschen", "Flüstern", "Lachen", "Fabelhaft sagen", "Spinne sehen", "Zeit fragen", "Summen", "Wort wiederholen", "Fenster gucken", "Pfeifen", "Hobby erklären", "Redewendung falsch", "Glas Boden", "Mücke fangen", "Toast-Geruch", "Selfie", "Story-Abbruch", "High-Five", "Kapuze", "Handy laut", "Geister-Frage", "Deja-vu", "3-Wort-Sätze", "Starren", "Komplimente", "Laut trinken", "Songzeile", "Kerze", "Dino-Frage", "Krampf", "Wasser-Vortrag", "Promi", "Tisch putzen", "Wild tippen", "Stimme ändern", "Kartenspiel", "Jingle", "Kette", "Traum", "Verabschieden", "Hüpfen", "Wasser fragen", "Zutaten", "4 Liter", "Haustier", "Starren", "Ecke zeigen", "Glas Kopf", "Alligator", "Antiquiert", "Akustik", "Sternzeichen", "Spitzname", "Glas beidseitig", "Zombie", "Film", "Stift", "Serie", "Husten", "Lob", "App", "Promi", "Holz", "Ananas", "Foto", "Instrument", "Typisch ich", "Wort vergessen", "Eichhörnchen", "Monat", "Zeh schläft", "Ente-Pferd", "Dehnen", "Pizza", "Wort erfunden", "Regen", "Island", "Kaugummi", "WLAN", "Farben", "Wackeln", "Peinlich", "Vegi", "Vorname", "Blau", "Remote", "Geschenk", "Schlumpf", "Wettbewerb", "Delfin", "Nass", "Schnurrbart", "Socken", "So!", "Hut", "Sauer?", "Akzent", "Opa", "Tja"],
    hard: ["Socken falsch", "Klopfen", "5 Liegestütze", "Aufstehen", "Akzent", "Wasser Rede", "Boden", "Schluckauf", "High-Five halt", "Panik", "Handy suchen", "Luftgitarre", "Simulation", "Over", "Ecke", "Geist-SMS", "Versicherung", "Schuhe Hände", "Singen", "Brot-Wiki", "Schuh-Foto", "Namen vergessen", "Gabel-Lob", "Flüstern", "Unsichtbarer Streit", "Zeitreisender", "Alle singen", "Topf Hut", "Reimen", "Allergie", "Hand halten", "Toaster", "Zeitlupe", "Haar riechen", "Majestät", "Chips", "Hund", "Macht", "Spion", "Tier", "Setzen verlernt", "La-Ola", "Exen", "Katze", "Mond", "Pinguin", "Krawatte", "Brille suchen", "Rettung", "Fragen", "Sprache", "Aura", "Tanz", "Biss", "Dunkelheit", "Werwolf", "Schatten", "Grüne Haare", "Socken lesen", "Phobie", "Farben hören", "Knie taufen", "Maschine", "Rad", "Falscher Name", "Hut", "Löffel", "König", "Atmen", "Revier", "Starren", "Weltuntergang", "Agent", "Star Wars", "Rund-Angst", "Zwerg", "Arm", "Schaufel", "Pflanze", "Wand", "Kalorien", "Formel 1", "Geräte", "Leinwand", "Schreiten", "Fliege", "Käse", "Freund", "Ohnmacht", "Internet", "Sind wir da?", "Remote", "Schatten", "Socken", "Gehirnzelle", "Hypnose", "Sauerstoff", "Keks-Selfie", "Yoga", "Verkaufen", "Fäden"]
};

let score = 0;
let cards = [];
let doneChallenges = [];
let usedTexts = new Set();
let isDragging = false;
let startX = 0;
let currentX = 0;

function startGame() {
    showScreen('screen-game');
    // Stapel mit 6 Karten füllen
    cards = [
        {type:'easy', text: getQuest('easy')},
        {type:'easy', text: getQuest('easy')},
        {type:'medium', text: getQuest('medium')},
        {type:'medium', text: getQuest('medium')},
        {type:'hard', text: getQuest('hard')},
        {type:'hard', text: getQuest('hard')}
    ];
    renderCards();
}

function getQuest(lvl) {
    const pool = CHALLENGES[lvl];
    const avail = pool.filter(t => !usedTexts.has(t));
    const final = avail.length > 0 ? avail : pool;
    const picked = final[Math.floor(Math.random() * final.length)];
    usedTexts.add(picked);
    return picked;
}

function renderCards() {
    const container = document.getElementById('card-container');
    container.innerHTML = "";
    cards.forEach((card, i) => {
        const div = document.createElement('div');
        div.className = `card ${card.type}`;
        div.innerHTML = `<div class="card-lvl">${card.type}</div><div class="card-text">${card.text}</div>`;
        if (i === 0) {
            div.addEventListener('mousedown', dragStart);
            div.addEventListener('touchstart', dragStart);
        }
        container.appendChild(div);
    });
}

function dragStart(e) {
    isDragging = true;
    startX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
    const card = document.querySelector('.card:first-child');
    card.style.transition = 'none';
    document.addEventListener('mousemove', dragMove);
    document.addEventListener('touchmove', dragMove);
    document.addEventListener('mouseup', dragEnd);
    document.addEventListener('touchend', dragEnd);
}

function dragMove(e) {
    if (!isDragging) return;
    const x = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
    currentX = x - startX;
    const card = document.querySelector('.card:first-child');
    card.style.transform = `translateX(${currentX}px) rotate(${currentX/20}deg)`;
    if (currentX > 50) card.style.backgroundColor = "rgba(34, 197, 94, 0.6)";
    else if (currentX < -50) card.style.backgroundColor = "rgba(239, 68, 68, 0.6)";
    else card.style.backgroundColor = "var(--card-bg)";
}

function dragEnd() {
    isDragging = false;
    const card = document.querySelector('.card:first-child');
    card.style.transition = 'all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
    
    if (currentX > 120) {
        card.style.transform = 'translateX(200%) rotate(45deg)';
        setTimeout(() => handleAction(true), 300);
    } else if (currentX < -120) {
        card.style.transform = 'translateX(-200%) rotate(-45deg)';
        setTimeout(() => handleAction(false), 300);
    } else {
        card.style.transform = 'translateX(0) rotate(0)';
        card.style.backgroundColor = "var(--card-bg)";
    }
    document.removeEventListener('mousemove', dragMove);
    document.removeEventListener('touchmove', dragMove);
    currentX = 0;
}

function handleAction(success) {
    const card = cards.shift();
    if (success) {
        score += (card.type==='easy'?5:card.type==='medium'?10:20);
        doneChallenges.push(card);
    } else {
        score -= 2;
    }
    cards.push({type: card.type, text: getQuest(card.type)});
    document.getElementById('display-score').innerText = score;
    renderCards();
}

function endGameRequest() {
    showScreen('screen-review');
    const list = document.getElementById('review-list');
    list.innerHTML = "";
    doneChallenges.forEach((card, i) => {
        const div = document.createElement('div');
        div.className = "review-item";
        div.id = `rev-${i}`;
        div.innerHTML = `<span>${card.text}</span><button class="btn-del" onclick="toggleVeto(${i})">X</button>`;
        list.appendChild(div);
    });
}

function toggleVeto(i) {
    const item = document.getElementById(`rev-${i}`);
    const card = doneChallenges[i];
    const val = (card.type==='easy'?5:card.type==='medium'?10:20);
    if (item.classList.contains('removed')) {
        item.classList.remove('removed');
        score += val;
    } else {
        item.classList.add('removed');
        score -= val;
    }
    document.getElementById('display-score').innerText = score;
}

function showFinalResult() {
    showScreen('screen-result');
    document.getElementById('final-score').innerText = score;
}

function showScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}
</script>
</body>
</html>
